import requests

from utils.utils import is_vulnerable
from utils.request import get_request

class VG1_NoFilter:
    def execute(file_upload_url):
        headers, encoder = get_request()
        
        response = requests.post(file_upload_url, data=encoder, headers=headers)
        status = "Vulnerable" if is_vulnerable(response.text, response.status_code) else "Not Vulnerable"

        encoder.fields["image"][1].close()

        return {
            "ID": "VG1",
            "Name": "No Filter",
            "Score": "8.3",
            "Severity": "High",
            "Status": status,
        }
    